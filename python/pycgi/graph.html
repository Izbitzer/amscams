<head>
	<script src="/js/plotly-latest.min.js"></script>
</head>
<body style="margin:0;padding:0;background:transparent">
<div id="graph" style="width:100%; margin: 0 auto" ></div>
</body>

<script>
function getQueryVariable(variable) {
   var query = window.location.search.substring(1);
   var vars = query.split("&");
   for (var i=0;i<vars.length;i++) {
      var pair = vars[i].split("=");
      if(pair[0] == variable){return pair[1];}
   }
   return(false);
}

all_data = {
   'title': getQueryVariable("title")?getQueryVariable("title").replace(/_/g, ' '):'No Title',        // Main Title
   'x_title': getQueryVariable("xat")?getQueryVariable("xat").replace(/_/g, ' '):'',                  // Title for X
   'y_title': getQueryVariable("yat")?getQueryVariable("yat").replace(/_/g, ' '):'',                  // Title for Y
   'x1_vals': getQueryVariable("x1_vals")?getQueryVariable("x1_vals").split(","):false,                  // X Values - SERIE 1
   'y1_vals': getQueryVariable("y1_vals")?getQueryVariable("y1_vals").split(","):false,                  // Y Values - SERIE 1 
   'title1': getQueryVariable("title1")?getQueryVariable("title1").replace(/_/g, ' '):'',                // Name SERIE 1
   'x2_vals': getQueryVariable("x2_vals")?getQueryVariable("x2_vals").split(","):false,                  // X Values - SERIE 2
   'y2_vals': getQueryVariable("y2_vals")?getQueryVariable("y2_vals").split(","):false,                  // Y Values - SERIE 2
   'title2': getQueryVariable("title2")?getQueryVariable("title2").replace(/_/g, ' '):'',                // Name SERIE 2
   'x_texts': getQueryVariable("tx1")?getQueryVariable("tx1").split(","):'',                          // Name of the X values (?)
   'y_texts': getQueryVariable("ty1")?getQueryVariable("ty1").split(","):'',                          // Name of the Y values (?)
   't1d': getQueryVariable("t1d")?getQueryVariable("t1d"):"points",                                   // Type of line 1
   't2d': getQueryVariable("t2d")?getQueryVariable("t2d"):"fit",                                      // Type of line 2
   'wtf' : getQueryVariable("ry"),                                                                    // No fucking clue
}

// Build the graph based on options

// Point Data
var trace1 = {
  x: all_data.x1_vals,
  y: all_data.y1_vals, 
  mode: 'markers',   // lines+
  type: 'scatter',
  marker : { symbol: 'star-diamond', color:'orange' },
  xaxis: "x1",
  yaxis: "y1",
  name: all_data.title1
};

var layout = {
   title: {
      text: all_data.title, 
      font: {  color:'#ffffff' },
      xref: 'x',   
      yref: 'y',  
      x: 0.05, 
   },
   height: 517,
   width: 937,
   paper_bgcolor: "rgba(9,29,63,1)",  // For exporting in PNG!
   plot_bgcolor: "rgba(9,29,63,1)",   // For exporting in PNG!
   xaxis:{
         autorange: true,
         zerolinecolor: 'rgba(255,255,255,.8)', 
         zerolinewidth: 1,
         gridcolor: 'rgba(255,255,255,.5)', 
         linecolor: 'rgba(255,255,255,.8)',  
         title: { font: { size: 15, color: '#b1b1b1' } },
         tickfont: { color: 'rgba(255,255,255,.5)'}
   },
   yaxis:{
         zerolinecolor: 'rgba(255,255,255,.8)', 
         zerolinewidth: 1, 
         gridcolor: 'rgba(255,255,255,.5)', 
         linecolor: 'rgba(255,255,255,.8)',
         title: { font: {  size: 15, color: '#b1b1b1' }},
         autorange: 'reversed' ,
         tickfont: { color: 'rgba(255,255,255,.5)'},
         scaleanchor:"x", 
         scaleratio:1
   },
   showlegend: false
}

var data = [trace1];
Plotly.newPlot("graph", data, layout, {responsive: true});
 

//If we have 2 set of data
if (x2_vals != false && y2_vals != false) {

   // We add the 2nd "trace"
   Plotly.addTraces("graph", {
      x: x2_vals,
      y: y2_vals,
      mode: 'lines',
      type: 'scatter',
      color:'blue',
      name: all_data.title2
      yaxis: "x2"
   });
}


/*

if (ry != false) {
   
}
else {

   var layout = {
  title: {
    text: plot_title,
    font: { 
      size: 24
    },
    xref: 'paper',
    x: 0.05,
  },
       height: 517,
       width: 920,
       xaxis:{
       title: {
            text: xat,
            font: { 
               size: 18,
               color: '#7f7f7f'
            }
          },

           side:'left'
       },
       yaxis:{
           title: {
             text: yat,
             font: { 
               size: 18,
               color: '#7f7f7f'
             }
           },

           side: 'right'
       }
   }

}
*/
Plotly.newPlot("graph", data, layout, {responsive: true}) 
/*if (tx1 != false) {
   Plotly.addTraces("myDiv", trace2)
   
if (tx1 != false) {
   tx1a = tx1.split(",")
   ty1a = ty1.split(",")
   var trace2 = {
      x: tx1a,
      y: ty1a,
      mode: 'lines',
      type: 'scatter',
      name: t2d,
      yaxis: "x2"
   };

   console.log('HERE');
}
}*/
</script>
